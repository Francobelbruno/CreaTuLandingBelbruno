import{u as y,r as m,j as e,L as g}from"./index-DPZ3TDY9.js";import{e as C,c as w,b as S,s as T}from"./firebase-D-P0CyqM.js";import{S as f}from"./sweetalert2.esm.all-DzlfzZPw.js";const E="orders";async function I({buyer:n,items:s,total:o}){return(await C(w(S,E),{buyer:n,items:s,total:o,createdAt:T()})).id}function k(){const{items:n,totalPrice:s,clearCart:o}=y(),[r,p]=m.useState({name:"",email:"",phone:""}),[d,u]=m.useState(!1),[h,x]=m.useState(null),c=l=>{const{name:a,value:t}=l.target;p(i=>({...i,[a]:t}))},j=async l=>{l.preventDefault(),u(!0);try{const a={buyer:r,items:n.map(({id:i,title:b,price:N,quantity:v})=>({id:i,title:b,price:N,quantity:v})),total:s},t=await I(a);x(t),o(),await f.fire({icon:"success",title:"Compra realizada",html:`Tu número de orden es: <strong>${t}</strong>`,confirmButtonText:"Perfecto"})}catch(a){console.error("Error creating order",a),await f.fire({icon:"error",title:"Error",text:"Ocurrió un problema al procesar la orden. Intenta nuevamente."})}finally{u(!1)}};return h?e.jsxs("div",{className:"container py-4",children:[e.jsx("h2",{children:"¡Gracias por tu compra!"}),e.jsxs("p",{children:["Tu número de orden es: ",e.jsx("strong",{children:h})]}),e.jsx(g,{to:"/",className:"btn btn-primary",children:"Volver al inicio"})]}):e.jsxs("div",{className:"container py-4",children:[e.jsx("h2",{children:"Checkout"}),e.jsxs("form",{onSubmit:j,className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Nombre"}),e.jsx("input",{className:"form-control",name:"name",value:r.name,onChange:c,required:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Teléfono"}),e.jsx("input",{className:"form-control",name:"phone",value:r.phone,onChange:c,required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",name:"email",value:r.email,onChange:c,required:!0})]}),e.jsxs("div",{className:"col-12 d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"fs-5",children:["Total: ",new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(s)]}),e.jsx("button",{className:"btn btn-success",type:"submit",disabled:d,children:d?"Procesando...":"Confirmar compra"})]})]})]})}export{k as default};
